<a href="https://colab.research.google.com/github/DmitryKostin/yandex-praktikum-data-analyst/blob/main/12_final_ab_test_analysis/final_ab_test_analysis.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a>

[![nbviewer](https://raw.githubusercontent.com/jupyter/design/master/logos/Badges/nbviewer_badge.svg)](https://nbviewer.org/github/DmitryKostin/yandex-praktikum-data-analyst/blob/main/12_final_ab_test_analysis/final_ab_test_analysis.ipynb)

# Выпускной проект. Анализ процесса проведения и результатов A/B-тестирования

## Описание проекта
**Цель проекта** — провести оценку результатов A/B-теста. В нашем распоряжении есть датасет с действиями пользователей, техническое задание и несколько вспомогательных датасетов. Задачи проекта:

- оценить корректность проведения теста;
- проанализировать результаты теста.

Чтобы оценить корректность проведения теста, необходимо проверить:

- пересечение тестовой аудитории с конкурирующим тестом;
- совпадение теста и маркетинговых событий, другие проблемы временных границ теста.

## Техническое задание
- Название теста: `recommender_system_test`;
- группы: А — контрольная, B — новая платёжная воронка;
- дата запуска: 2020-12-07;
- дата остановки набора новых пользователей: 2020-12-21;
- дата остановки: 2021-01-04;
- аудитория: 15% новых пользователей из региона EU;
- назначение теста: тестирование изменений, связанных с внедрением улучшенной рекомендательной системы;
- ожидаемое количество участников теста: 6000.
- ожидаемый эффект: за 14 дней с момента регистрации пользователи покажут улучшение каждой метрики не менее, чем на 10%:
    - конверсии в просмотр карточек товаров — событие `product_page`,
    - просмотры корзины — `product_cart`,
    - покупки — `purchase`.

## Выводы и рекомендации

Для корректного повторного A/B-тестирования, результаты которого действительно можно было бы анализировать и интерпретировать, рекомендуется следующее:

- Провести тест в любое другое время, не выпадающее на маркетинговые активности кампании и долгие праздничные дни.
- При проведении теста не отклоняться от технического задания и не прерывать тест до финальной даты исследования.
- Заново рассчитать точные размеры выборок для ожидаемого эффекта, например, с помощью калькулятора Эвана Миллера (https://www.evanmiller.org/ab-testing/sample-size.html). - При возможности снизить размер ожидаемого эффекта до 5-10%.
- Контролировать размеры групп на каждом этапе и не допускать дисбаланса на более чем 5%.
- Снизить горизонт активности новых пользователей до 10 дней.
- Собирать данные о логировании пользователей и длительности их сессий.

В процессе анализа корректности проведения теста были выявлены следующие факты:

- Согласно техническому заданию, аудиторией главного теста является регион EU. Данному региону принадлежат 75% пользователей.
- В данных были отфильтрованы только пользователи из региона EU.
- 36.7% пользователей являются участниками recommender_system_test. 63.3% пользователей участвуют в interface_eu_test.
- После проверки на пересечение выборок были исключены пользователи из конкурирующего теста на основании того, что влияние измененого интерфейса и дизайна может привести к нетипичному поведению пользователей в группах и исказить результаты главного тестирования.
- 2 маркетинговые кампании выпадают на период теста, что является существенным нарушением при проведении теста. Маркетинговая кампания приводит к нетипичному поведению пользователей, привлекая их повышенный интерес.
- Конкретно региона EU касается только кампания Christmas & New Year Promo. Тем не менее, это негативно влияет на корректность тестирования и искажает результаты.
- Весомым фактором является выбор самого времени проведения теста. Новогодние праздники сильно меняют поведение пользователей, в связи с чем время проведения выбрано некорректно.
- Группы A и B главного теста recommender_system_test сильно несбалансированы. По численности пользователей группа А превышает группу B на четверть (около 25%). Это является существенным нарушением и говорит о некорректности разбиения на группы в тесте.
- Смешивания групп A и B в главном тесте не выявлено.
- Обнаружено пересечение с конкурирующим тестом в размере 1 602 пользователя. Поскольку тест является конкурирующим - смешивание пользователей негативно сказывается на результатах обоих тестов.
- В датасете participants были оставлены только участники главного теста recommender_system_test. Были исключены пользователи, попавшие в оба тестирования - таких пользователей 1 602.
- В датасете participants остались только уникальные пользователи из региона EU, участвующие только в тесте recommender_system_test - на данном этапе их число 5 099.
- Выявлено, что в главном тесте участвуют пользователи, зарегистрировашиеся с 7 по 21 декабря.
- Из датафрейма new_users были исключены пользователи, которые зарегистрировались после 21 декабря.
- Были получены данные о 42 340 пользователях, из которых 5 099 принимают участие в главном тестировании.
- Наблюдается дисбаланс групп - разница составляет 25%.
- Набор новых пользователей из EU остановился 21 декабря, но не совпадает с ТЗ заказчика - по состоянию на 4 января требование выполнено лишь на 79%, набрано 4 749 чел. из 6 000. Датафрейм participants насчитывает 5 099 чел., но только 4 749 из них являются новыми пользователями.

По итогам исследовательского анализа данных можно утверждать следующее:

- В датафрейме data были агрегированы данные о 21 115 событиях 5 099 участников теста.
- Фактически, тестирование прервалось на 5 дней раньше запланированного срока - вместо 4 января конец зафиксирован 29 декабря. Данные о событиях перестали собираться по неизвестным причинам. Возможно, из-за новогодних праздников тест перестал выполняться технически.
- Поскольку дата окончания теста (4 января) сместилась на более раннюю дату, то соответственно сместился и горизонт теста в размере 14-ти дней. Изначально, этой точкой была дата окончания приема новых пользователей - 21 декабря, но из-за смещения теста горизонт сместился в район 16 декабря.
- После фактического окончания теста зафиксировано несколько событий в районе 6 утра 30 декабря, которые больше похожи на шум. Строки были удалены из датасета.
- Было принято решение удалить пользователей, которые с момента регистрации успели провести менее 14 дней активности до окончания теста. Было получено 1 314 человек.
- Группа А насчитывает 907 пользователей, группа B - 407 пользователей. Группа A превышает группу B в 2 раза - такой дисбаланс является грубым нарушением теста.
- Группа А (907 чел.) показывает большее количество событий в течение теста, чем группа B (407 чел.). Наибольшая активность пользователей наблюдается в период с 14 по 16 декабря.
- В среднем у пользователя группы А происходит около 7 событий, медианное значение 6. У пользователя группы B в среднем происходит меньше событий - около 6, медианное значение 5.
- Количество на этапах корзины и покупки (product_cart и purchase) схожи в количестве пользователей, что может свидетельствовать об ошибке при сборе данных или логировании.
- У 163 человек - первым действием сразу происходит покупка. Это говорит о том, что человек уже был зарегистрирован и залогирован ранее до начала теста - а значит, не является новым пользователем. В связи с тем, что это нарушает требование технического задания, было принято решение исключить пользователей, у которых login не является первым действием.
- Новые полученные пропорции групп составили 637 чел. в группе А и 292 чел. в группе B.
- Наблюдается существенный дисбаланс размера групп - группа А превосходит группу B более чем в 2 раза - как изначально, так и на каждом этапе воронки.
- Принимать результаты тестирования не рекомендуется. Тестирование было выполнено со множеством грубых нарушений, в связи с чем интерпретация полученных результатов теряет смысл. Большинство требований технического задания было удовлетворено лишь частично.
- Группа B является тестовой и демонстрирует более худшие показатели на каждом этапе воронки по сравнению с контрольной группой.
- Группа А демонстрирует конверсию в покупку на уровне 17%, группа B - на уровне 15%.

## Использованные библиотеки
```
pandas 
numpy 
datetime 
plotly 
scipy 
math
```
